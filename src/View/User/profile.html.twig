{% extends 'layout.html.twig' %}

{% block content %}
    {# {% include 'User/_navbar_profile.html.twig' %} #}

    {% if user.fridge_updated %}
        <div class="alert alert-success alert-dismissible fade show text-center" role="alert">
            {{ user.fridge_updated }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endif %}
    <div class="container justify-content-center my-5">
        <div class="row">
            <div class="col-4"> 
                <div class="card p-4 mb-4">
                    <div class="image d-flex flex-column justify-content-center align-items-center">
                        <button class="btn btn-success btn-rounded">
                            <img src="https://i.imgur.com/wvxPV9S.png" height="100" width="100" />
                        </button> 
                        <span class="name mt-3">{{ user.firstname }} {{user.lastname}}</span>
                        <span class="idd">{{ user.email }}</span>  
                        <div class="d-flex mt-2"> 
                            <a href="/users/edit?id={{ user.id }}" class="btn btn-dark text-light f-w-bold">Edit Profile</a>
                        </div> 
                        <div class="text mt-3">
                            <span class="fst-italic">
                                « {{ user.bio }} »
                            </span> 
                        </div>
                        <div class="row g-4 mt-3 align-items-center">
                            <div class="col">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="icon icon-facebook" viewBox="0 0 16 16">
                                    <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"/>
                                </svg>
                            </div> 
                            <div class="col">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="icon icon-twitter" viewBox="0 0 16 16">
                                    <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/>
                                </svg>
                            </div>
                            <div class="col">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="icon icon-slack" viewBox="0 0 16 16">
                                    <path d="M3.362 10.11c0 .926-.756 1.681-1.681 1.681S0 11.036 0 10.111C0 9.186.756 8.43 1.68 8.43h1.682v1.68zm.846 0c0-.924.756-1.68 1.681-1.68s1.681.756 1.681 1.68v4.21c0 .924-.756 1.68-1.68 1.68a1.685 1.685 0 0 1-1.682-1.68v-4.21zM5.89 3.362c-.926 0-1.682-.756-1.682-1.681S4.964 0 5.89 0s1.68.756 1.68 1.68v1.682H5.89zm0 .846c.924 0 1.68.756 1.68 1.681S6.814 7.57 5.89 7.57H1.68C.757 7.57 0 6.814 0 5.89c0-.926.756-1.682 1.68-1.682h4.21zm6.749 1.682c0-.926.755-1.682 1.68-1.682.925 0 1.681.756 1.681 1.681s-.756 1.681-1.68 1.681h-1.681V5.89zm-.848 0c0 .924-.755 1.68-1.68 1.68A1.685 1.685 0 0 1 8.43 5.89V1.68C8.43.757 9.186 0 10.11 0c.926 0 1.681.756 1.681 1.68v4.21zm-1.681 6.748c.926 0 1.682.756 1.682 1.681S11.036 16 10.11 16s-1.681-.756-1.681-1.68v-1.682h1.68zm0-.847c-.924 0-1.68-.755-1.68-1.68 0-.925.756-1.681 1.68-1.681h4.21c.924 0 1.68.756 1.68 1.68 0 .926-.756 1.681-1.68 1.681h-4.21z"/>
                                </svg>
                            </div>
                            <div class="col">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="icon icon-linkedin" viewBox="0 0 16 16">
                                    <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="p-3 rounded mt-4 text-light fw-bold text-center bg-success">
                            <span class="join text-uppercase">Wilder ECO RESPONSABLE depuis le {{ user.registration_date|format_datetime('long', 'none', locale='fr') }}</span>
                        </div>
                    </div> 
                </div>
                <div class="card p-4">
                    <img src="/assets/images/ecolecologie.jpg">
                </div>
            </div>
            <div class="col-8">
                <div class="card pt-3 w-100 mb-4">
                    <div class="row mb-2">
                        <h2 class="text-success text-uppercase text-center fw-bold fs-6">Tu es inscrits dans la promo {{ user.promo_name }}</h2>
                        <span class="text-center d-block fs-6">
                            Session {{ user.promo_debut|format_datetime('long', 'none',locale='fr') }} 
                            au {{ user.promo_end|format_datetime('long', 'none', locale='fr') }}
                        </span>
                    </div>
                </div>
                <div class="card py-2 w-100 mb-4">
                    <h6 class="text-success text-uppercase text-center fw-bold">Etat du frigo et stockage à durée limitée de vos aliments</h6>
                    <div class="form-check form-switch">
                        <div class="text-center">
                            <form id="fridgeCheck" method="POST">
                                {% set statusCheck = '<input class="form-check-input float-none" type="checkbox" role="switch" name="fridge_used" id="flexSwitchCheckDefault fridge">' %}
                                {% set labelStatusCheck = 'flexSwitchCheckDefault' %}
                                {% if user.fridge_used == 1 %}
                                    {% set statusCheck = '<input class="form-check-input float-none" type="checkbox" role="switch" name="fridge_used" id="flexSwitchCheckChecked fridge" checked>' %}
                                    {% set labelStatusCheck = 'flexSwitchCheckChecked' %}
                                {% endif %}
                                {{ statusCheck|raw }}
                                <label class="form-check-label" for="{{ labelStatusCheck }}">Avez-vous actuellement de la nourriture dans le frigo ?</label>
                                <input type="hidden" name="id" value="{{user.id}}">
                                <button type="submit" name="changeFridgeValue" class="btn btn-primary">Valider</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="card p-4 w-100">
                    <h2 class="text-success text-uppercase text-center fw-bold align-items-center fs-5 pt-2"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-calendar3" viewBox="0 0 16 16">
                        <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z"/>
                            <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                        </svg>
                        Planning des actions écologiques
                    </h2>
                    <div class="alert alert-secondary text-justify my-4" role="alert">
                        Le planning des actions écologique affiche les semaines durant lesquelles, ta promo devra mettre en place les différents mission à caractères écologiques (trie des déchets, vidage du frigo, etc...) pour l'ensemble de ton campus. </br>
                        Dans un esprit de collaboration, tu peux si tu le souhaites, te joindre à une autre promo de ton campus si c'est à son tour d'etre missionnée.
                    </div>
                    <ul class="list-group my-4">
                        {% for planning in plannings %}
                            {% set disabled = '' %}
                            {% set color = 'success' %}
                            {% set textcolor = 'success' %}
                            {% set fontweight = 'fw-bold' %}
                            {% if user.promo_name is not same as(planning.promo_name) %}
                                {% set disabled = ' disabled' %}
                                {% set color = 'gray' %}
                                {% set textcolor = 'secondary' %}
                                {% set fontweight = '' %}
                            {% endif %}
                            {% if loop.index == 1 %}
                                {% set textcolor = 'light' %}
                                {% set fontweight = '' %}
                                <li class="list-group-item{{ disabled }} align-items-center bg-dark text-light py-3" aria-current="true">
                            {% else %}
                                <li class="list-group-item align-items-center py-3{{ disabled }}">
                            {% endif %}
                                <div class="row g2">
                                    <div class="col-7 text-{{ textcolor }} {{ fontweight }}">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-record-circle-fill me-2 text-{{ color }}" viewBox="0 0 16 16">
                                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-8 3a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                        </svg>
                                            Semaine du {{ planning.week_start|format_datetime(pattern='d MMM', locale='fr') }} au {{ planning.week_end|format_datetime('medium', 'none', locale='fr') }}
                                    </div>
                                    <div class="col-5">
                                        <div class="row g-2">
                                            <div class="col-2">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-recycle fw-bold text-{{ color }}" viewBox="0 0 16 16">
                                                    <path d="M9.302 1.256a1.5 1.5 0 0 0-2.604 0l-1.704 2.98a.5.5 0 0 0 .869.497l1.703-2.981a.5.5 0 0 1 .868 0l2.54 4.444-1.256-.337a.5.5 0 1 0-.26.966l2.415.647a.5.5 0 0 0 .613-.353l.647-2.415a.5.5 0 1 0-.966-.259l-.333 1.242-2.532-4.431zM2.973 7.773l-1.255.337a.5.5 0 1 1-.26-.966l2.416-.647a.5.5 0 0 1 .612.353l.647 2.415a.5.5 0 0 1-.966.259l-.333-1.242-2.545 4.454a.5.5 0 0 0 .434.748H5a.5.5 0 0 1 0 1H1.723A1.5 1.5 0 0 1 .421 12.24l2.552-4.467zm10.89 1.463a.5.5 0 1 0-.868.496l1.716 3.004a.5.5 0 0 1-.434.748h-5.57l.647-.646a.5.5 0 1 0-.708-.707l-1.5 1.5a.498.498 0 0 0 0 .707l1.5 1.5a.5.5 0 1 0 .708-.707l-.647-.647h5.57a1.5 1.5 0 0 0 1.302-2.244l-1.716-3.004z"/>
                                                </svg>
                                            </div>
                                            <div class="col">
                                                <span class="badge bg-{{ color }} fs-6 w-100">
                                                    {{ planning.promo_name }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        {% else %}
                            <p class="text-center">Il n'y a pas d'actions écologiques prévue durant les prochaines semaines</p>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="border-top mt-4 pt-5"> 
        <form action="/users/delete" method="POST">
            <input type="hidden" name="id" value="{{ user.id }}">
            <p class="text-center text-mini main-text-color">
                Si vous souhaitez désactiver votre compte
                <button type="submit" class="btn btn-outline-secondary btn-sm pt-0 pb-0">cliquez ici</button><br>
                Attention, la désactivation de votre compte est définitive !<br />
                <span class="text-danger">Vous ne pourrez plus récupérer votre compte.</span>
            </p>
        </form>
    </div>

    <div class="container">
        <div class="powr-chat" id="1dd7ec70_1652444868"></div><script src="https://www.powr.io/powr.js?platform=bootstrap"></script>
    </div>
{% endblock %}
